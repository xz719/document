# 服务端渲染与客户端渲染

在开始之前，我们首先需要弄清楚，什么是渲染？其实没有必要说的很复杂，渲染实际上就是将数据展示在页面上，更具体一点，就是利用 js 将数据组装成 html 结构，然后放在页面上展示。

## 1. 客户端渲染 CSR（Client Side Rendering）

客户端渲染，就是指直接推送可生成完整应用的静态资源和空 HTML 模版至客户端，然后在客户端通过 JS 加载页面数据，并在浏览器中**动态**生成 HTML 页面。

### 1.1 理解客户端渲染

在客户端渲染的过程中发生了什么？

1. 在浏览器地址栏通过 url 访问网站
2. 浏览器根据 url 找到指定服务器，拿到网站的 html 文件
3. 浏览器解析这个文件，执行其内部的 js 代码
4. 遇到 ajax 请求，则向服务器发送请求，获取返回的数据
5. 将返回的数据渲染再页面上

显然，这种方式可以实现高度的交互性以及内容的实时更新，例如我点击某个地方，可以在页面整体不变的情况下，动态地更新页面的某个部分。但如果首屏需要请求的内容较多，会导致首屏加载速度较慢。

### 1.2 客户端渲染的实例

客户端渲染的实例其实很多，比如管理后台的表格分页、商城的商品分类等等。

这里我们来看看京东的商品评论：

![在这里插入图片描述](https://pic1.zhimg.com/v2-0e1d945a4e95fe0e83e471fdc6d55ffc_b.webp)

在上面我们说过，客户端渲染是在拿到 html 文件后，就开始解析渲染了，而且，页面的某些部分是动态的，即根据服务器返回的数据来展示内容，所以，客户端渲染可以实现页面的局部刷新，就像这里，我点击评论的下一页，整个页面没有刷新，url 也没有变化，仅仅是评论这一个区域的数据发生了变化。具体到代码实现，实际上就是在点击下一页时，发送请求，拿到这一页的评论数据，然后再对这部分重新 render 一下。

### 1.3 客户端渲染的优点

上面我们了解了客户端渲染的过程和一个客户端渲染的实例，接下来让我们看看客户端渲染的优点：

1. 【高度的交互性和实时性】：客户端渲染可以实现丰富的用户交互和实时更新，可以给用户很好的使用体验，适用于高交互性的应用。
2. 【减轻服务器压力】：客户端渲染将渲染工作分散到各个客户端，降低了服务器端的压力。
3. 【支持前后端分离】：客户端渲染可以实现前后端分离，便于开发和维护

### 1.4 客户端渲染的缺点

有优点必然就会有缺点：

1. 【SEO 问题】：客户端渲染生成的HTML页面在页面加载初期为空，可能导致搜索引擎无法抓取和索引页面内容。
2. 【首屏加载速度较慢】：客户端渲染需要等待 JavaScript 执行完成才能展示页面内容，可能导致首屏加载速度较慢。
3. 【客户端计算负担较重】：客户端渲染将渲染工作集中在客户端，可能导致客户端计算负担增加。

## 2. 服务端渲染 SSR（Server Side Rendering）

服务端渲染，就是指每当响应页面请求时**在服务端上**渲染出完整、包含数据的前端应用，并将渲染完成的 HTML 产物推送至客户端，客户端接收到 HTML 页面后，可以**直接展示给用户**，无需再进行额外的渲染操作。

### 2.1 理解服务端渲染

在服务端渲染的过程中发生了什么？

1. 用户在浏览器地址栏中输入 url 访问网站
2. 浏览器向指定的服务器发送请求
3. 服务器接收请求后，先找到网站的 html 文件，然后解析文件，找到这个文件内所需要的数据内容
4. 服务器利用这些数据直接渲染页面，然后将页面发送给客户端
5. 客户端接收到网页文件，不需要做任何其它操作，直接展现在浏览器中

### 2.2 服务端渲染的优点

服务端渲染的优点还是很明显的：

1. 【更好的 SEO】：服务端渲染生成的 HTML 页面包含了完整的页面内容，有利于搜索引擎抓取和索引。具体来说，就是服务端渲染的网页，可以直接在网页源代码中查找到网页上的内容，例如：

    [![pF69ZWT.md.png](https://s21.ax1x.com/2024/03/11/pF69ZWT.md.png)](https://imgse.com/i/pF69ZWT)

2. 【更快的首屏加载速度】：由于服务端渲染中，html 文件是在服务器中进行的渲染，客户端仅仅需要展示即可，所以客户端无需等待 JS 执行完毕即可展示页面内容，从而提高首屏加载速度。
3. 【减轻客户端压力】：服务端渲染中，将工作集中在了服务器端，降低了客户端的计算负担。

### 2.3 服务端渲染的缺点

同样地，有优点就会有缺点：

1. 【服务器压力较大】：前面说到过，服务端渲染将工作集中在了服务器端，理所应当会导致服务器压力增加
2. 【客户端与服务端通信延迟】：服务端渲染时，需要客户端与服务端进行多次通信，且每次都是请求一个完整的页面，可能会导致延迟增加。同时，如果服务端需要渲染的内容较多，可能会导致白屏。
3. 【不适用于高交互性的应用】：服务端渲染难以支持复杂的用户交互和实时更新

## 3. 如何选择渲染策略？

总结来说，客户端渲染中，页面的渲染工作都由客户端完成，但其不容易被爬虫爬取数据，也无法被搜索引擎搜索到网页中的内容；而服务器渲染，则是由服务端完成页面的渲染工作，客户端仅需展示即可，所以其更容易被爬虫爬取数据，也更容易被搜索引擎搜索到。

那么，用哪种策略更好呢？

根据实际的需求场景，下面是一些建议：

1. 对于以【内容】为主的网站，如：博客、新闻网、文档、官网之类的，建议采用服务器渲染，以提高 SEO 以及首屏加载速度。
2. 对于【高交互性】的应用，如：电商网站、社交平台、管理后台等等，建议采用客户端渲染，以实现丰富的用户交互和实时更新。
3. 对于即需要 SEO 优化，又需要高交互性的应用，可以考虑采用同构渲染（Isomorphic Rendering），即在服务端和客户端共享一套代码，实现服务端渲染和客户端渲染的结合。

其实在大多数页面中，最好还是两者结合使用，因为我们想要网页的数据能够被搜索引擎搜索到，但是，我们又会有一些数据不想过早地传递过来，而是在被需要时采取获取数据，而且也不想这些数据被爬虫轻易爬取到。

总之，服务端渲染和客户端渲染各有优缺点，应根据实际需求选择合适的渲染策略。在实际开发中，也可以根据业务场景灵活运用这两种渲染方式，以达到最佳的性能和用户体验。
