# img 标签的 `srcset` 属性

## 1. 什么是 `srcset` 属性？

`srcset` 是 `<img>` 标签的一个属性，允许开发者为**不同的屏幕分辨率或设备条件指定多种图像源**。当浏览器加载页面时，它会根据设备的显示特性（如屏幕宽度、像素密度等）选择最合适的图片进行展示，从而提高页面的加载效率和图像的展示效果。

在没有 `srcset` 属性的情况下，浏览器只会加载 `src` 属性中指定的图片，这对于高分辨率显示屏或不同尺寸的设备来说，可能会**导致图像加载过慢或不清晰的问题**。而使用 `srcset`，可以避免这个问题，确保页面在各种设备上都能有更好的显示效果。

## 2. `srcset` 的语法与使用

### 2.1 基本语法

`srcset` 属性接受**一组图片源**，并**为每个图片源指定一个条件**，通常是**宽度（`w`）**或者**像素密度（`x`）**。浏览器会根据设备的条件选择最合适的图片加载。

**基于宽度 (`w`) 的用法：**

```html
<img src="image-1000w.jpg" srcset="image-500w.jpg 500w, image-1000w.jpg 1000w, image-1500w.jpg 1500w" alt="Responsive image">
```

宽度描述符就是图像原始的宽度，加上字符 `w`。上例的四种图片的原始宽度分别为 500 像素、1000 像素和 1500 像素。

**基于像素密度 (`x`) 的用法：**

```html
<img src="image-1x.jpg" srcset="image-1x.jpg 1x, image-2x.jpg 2x, image-3x.jpg 3x" alt="Responsive image">
```

在这个例子中，`srcset` 属性指定了三种不同像素密度的图片，浏览器会根据设备的屏幕分辨率选择最合适的图片。例如，拥有 2x 像素密度的设备（如一些 Retina 屏幕）将选择 image-2x.jpg，而普通屏幕（1x）会加载 image-1x.jpg。

### 2.2 `sizes` 属性的搭配使用

`srcset` 属性常常和 `sizes` 属性一起使用。`sizes` 属性告诉浏览器**在不同的布局条件下图片应该占据的宽度（通常是 CSS 中定义的宽度）**。这样，浏览器可以根据 `sizes` 和 `srcset` 属性提供的信息来选择最佳的图片源。

示例：

```html
<img src="image-160w.jpg"
     srcset="image-160w.jpg 160w, image-1000w.jpg 1000w, image-1500w.jpg 1500w"
     sizes="(max-width: 440px) 100vw,
            (max-width: 900px) 33vw,
            254px"
     alt="Responsive image">
```

上面代码中，`sizes` 属性给出了三种屏幕条件，以及对应的图像显示宽度。宽度不超过 440 像素的设备，图像显示宽度为 100%；宽度 441 像素到 900 像素的设备，图像显示宽度为 33%；宽度 900 像素以上的设备，图像显示宽度为 254px。

浏览器根据当前设备的宽度，从 `sizes` 属性获得图像的显示宽度，然后从 `srcset` 属性找出最接近该宽度的图像，进行加载。

假定当前设备的屏幕宽度是 480px，浏览器从 `sizes` 属性查询得到，图片的显示宽度是 33vw（即33%），等于 160px。`srcset` 属性里面，正好有宽度等于 160px 的图片，于是加载 image-160w.jpg。

## 3. `srcset` 的实际应用场景

### 3.1 响应式设计

在响应式 Web 设计中，`srcset` 可以帮助网站**根据不同设备的屏幕宽度和分辨率加载适合的图片**，确保页面在各种设备上都能够以最佳的效果显示。通过提供不同大小的图片，可以避免在小屏幕设备上加载过大的图片，减少加载时间和带宽消耗。

示例：响应式图片加载

```html
<img src="image-small.jpg"
     srcset="image-small.jpg 500w, image-medium.jpg 1000w, image-large.jpg 2000w"
     sizes="(max-width: 600px) 100vw, 50vw"
     alt="Responsive image">
```

在这个例子中，`srcset` 和 `sizes` 一起工作，使得网站可以在不同屏幕尺寸下选择合适的图片。对于宽屏设备，加载更高分辨率的图片；而对于手机，加载较小的图片，提升加载速度。

### 3.2 高分辨率屏幕优化

许多现代设备（如 iPhone、Retina 屏幕等）具有较高的像素密度（通常为 2x 或 3x）。如果你直接使用普通分辨率的图片，这些设备上的图片会显得模糊不清。通过使用 `srcset` 属性，你可以为不同的像素密度提供高分辨率的图片，保证图片在这些设备上保持清晰。

示例：高分辨率屏幕优化

```html
<img src="image-1x.jpg"
     srcset="image-1x.jpg 1x, image-2x.jpg 2x, image-3x.jpg 3x"
     alt="Responsive image">
```

在这个例子中，如果设备具有 2x 或 3x 的像素密度，浏览器将自动选择相应的图片源（如 image-2x.jpg 或 image-3x.jpg），确保图片在高分辨率设备上显示清晰。

### 3.3 图片加载优化与性能提升

`srcset` 属性有助于提高页面加载性能，尤其是在移动设备上。如果没有 `srcset`，浏览器只能加载一个固定尺寸的图片，而设备可能会加载比实际需要的大得多的图片，造成不必要的带宽消耗和加载延迟。而 `srcset` 使得浏览器可以根据实际需求选择合适大小的图片，优化了加载时间和带宽使用。

### 3.4 在图片懒加载场景中的应用

结合 `srcset` 和**图片懒加载技术**，可以在不影响页面性能的情况下，按需加载适合的图片。例如，在视口中出现时才加载图片，并根据设备屏幕大小和分辨率选择最佳图片。

## 4. `srcset` 使用时的注意事项

1. **图片格式的兼容性**： 并非所有的浏览器都支持所有图片格式（如 WebP）。因此，使用 srcset 时，最好确保提供兼容性较强的图片格式（如 JPG 和 PNG）作为回退选项，同时为现代浏览器提供 WebP 格式的图片，以实现更好的压缩效果。
2. **图片质量与大小的平衡**： 使用 srcset 时，应合理选择图片的分辨率和文件大小。过大的图片会增加加载时间和带宽消耗，过小的图片则可能导致显示不清晰。应根据设备的实际需求，提供合适的图片尺寸。
3. **浏览器支持**： 大部分现代浏览器都支持 srcset 属性，但一些旧版浏览器可能不支持。为了保证兼容性，可以提供传统的 src 属性作为回退，并结合 picture 元素进一步优化响应式图片的加载。

## 5. 总结

`srcset` 属性是 HTML5 中非常强大的一个功能，它允许开发者为不同屏幕尺寸和分辨率的设备提供合适的图片源，从而提高页面加载效率，优化图像显示效果。通过合理使用 `srcset`，可以实现响应式图片加载和高分辨率屏幕优化，提升用户体验和网页性能。

💡面试中可能考察点及回答：

* **`srcset` 属性的作用是什么？** --- `srcset` 属性允许开发者为不同设备和分辨率提供多种图片源，浏览器根据设备条件选择最合适的图片进行加载，提高页面的加载速度和图像的显示效果。
* **如何使用 `srcset` 属性优化网页性能？** --- 通过为不同分辨率和屏幕宽度的设备提供合适的图片源，避免不必要的带宽消耗和加载延迟，从而提高页面性能和用户体验。
